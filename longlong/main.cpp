#include "main.hpp"

using namespace std;



int secret_vector[N] = {
    217,
 0,
 2,
 0,
 2,
 0,
 0,
 2,
 2,
 0,
 1,
 0,
 2,
 1,
 2,
 2,
 2,
 2,
 0,
 0,
 2,
 2,
 0,
 1,
 2,
 1,
 2,
 0,
 2,
 1,
 2,
 0,
 1,
 0,
 0,
 0,
 0,
 0,
 1,
 0,
 0,
 2,
 0,
 0,
 2,
 2,
 1,
 1,
 0,
 2,
 2,
 2,
 0,
 2,
 2,
 0,
 1,
 0,
 0,
 0,
 1,
 1,
 0,
 1,
 1,
 1,
 0,
 1,
 0,
 0,
 1,
 1,
 1,
 0,
 2,
 1,
 2,
 2,
 2,
 2,
 0,
 2,
 1,
 0,
 1,
 1,
 2,
 0,
 1,
 1,
 1,
 1,
 2,
 0,
 2,
 2,
 2,
 0,
 0,
 2,
 2,
 2,
 1,
 0,
 2,
 0,
 0,
 0,
 1,
 0,
 0,
 0,
 0,
 0,
 2,
 2,
 0,
 0,
 0,
 2,
 0,
 0,
 2,
 0,
 2,
 2,
 2,
 0
};

mpz_class secret_vector_inv[N] = 
    {
    324850308941396174114686894413168531034001208468762707190153104294975497444259190308831234276898292379771761486296606349564398144417938819594654175499438749763362288733175993147130934765536136030315945797443094634397662667549026482932923147339258791302640113543942044796040105579484944173607_mpz,
 496694550806284952874298272881382952902935020217392302208258316898889786294451009333499054377844212747597570695271471423514401460585301195002557128962135217393352230116801956199854682401476371631078156661198463109792190542646196774442829764051993692368071666367038352216411694366264000927_mpz,
 -2430680775759704797685642170062587051786818402993294464266402147019118225535280781862210700239659563277364429440059686328238013649565833868771880604165976888846278850174973471014050963514349748251313734307171859922120536270863137319174870034389858657680599912555669108046984748284697252449_mpz,
 423396750781638346283902390495778072507630107057864873300589221152228623414644030747461550242794970299911657010886125074446697768992030889377515008528358553995314489815395464021648108832525236858122567405741528788428267939243134984276709123828525017669841585098810822365536140026374473431_mpz,
 -2490949385751596642465369360091566281712024452944805561030718817401364666136104968955202675598688201958945936618943423977637712734193439452273747213628066792023616952937343998753172371332404425624784470801237006722330415788176984972769166090253088877354449604765481205360415792595545083417_mpz,
 304890126432555151944138545731822094765532909734728542400414063321038746048605032121906704557857166705458631353308233175996164789580162313516559242800807134782882685963524800119081834506138937916460835486667411073012509167827077182988204554573359501916358091005191551667477863762847757343_mpz,
 437961128095594899879767743202860939632055665812762726247296646468562328781464167122450114480298993474165057382071348003962733517616997191741715001091388477941066775111985470091062253323646921352379574806250743724736710315708576328932372206912100806800863078494262397010945050055582579359_mpz,
 -2592716246646999872945847146705887061392118201660780484120619648816798994275598487846055117190082479317110072415105927254567352073210555835337740300019043786319943053689661476906219278074337308942873652560944116123853518786314540226141371734539574479468493060077404005194028985258714733801_mpz,
 -2593861133673652663995968377309477238519644638116245227542243700282421082097099730577712800876317945476645481318888486559355264735402892968490840497984418367448285418859678137142684732868240769244394702166319573391015631209238271850370914885061727320120380356219682147184110559996210150233_mpz,
 378874657102017263865334899370993370253634500523706287856987805021024405531508647162568524819688787236926710624764500984757832198053436855884862707209780931270853783970953614365120626250826381001666080055008624420994827299288508267946173156882941695761477681479772069910982778686186233247_mpz,
 -1040963482478675423260267308880014518405583037514262505254582526574559992912780440300553261182369397198839738213284815739868309551316784758978036865398516127341534979855094493920968870560618128838727012941361603607071469678673230627826131976716040236957225369650528009225972129381984626529_mpz,
 581758255569382502057132337827948865294338610945657858062862238438753118137800902399412017015238145085186802396430058865405211977636437828750740136131944864248202493045607537863855379723828416152381767350445288521458093808945230305601326207421124688221788731158791173323456134446561997911_mpz,
 -2398540334526947021430381996893262898628292703838267855014976483576363277438839763545222156031949605988775371943874022454513517493797633755112449519855303773206348665993772207788288378406169510569748496175202332363587328550920617216301693876349797962354517563823901303144680186155004986777_mpz,
 -1072841374429781703232892128927881031927120000803707934910367079635720810174995970132485253670505926468276490730136640634317736462285290828193843106829981079555872415575975172845126044354794162629358976094445897417104943207190337123151072599501091771954209086125240658870156740183132041697_mpz,
 -2449392735140292744339455968223505686886137978725968220299771502004636492222094785178749304097130442500659510966832894371101020307641867944053245065097724567612198341327335208890352005242532541603855638492092794249437523160639043797720565485124207569700271043952236851078243834124111540321_mpz,
 -2543896370660230206701949230672336364298985653389260529049280690943109944395808448019160121482552365607328585765416282269802437624911351015713667263298183600029166206156886232315431066371147157415604982562307201147541475884359013382674925989087689043527877279927335915528289161866309821801_mpz,
 -2543197797070735428393582295226848268021969911732860759230684766065929821718706022072148574677578380343742507214990298557642935502846624953369944271252734617514960423176655277686102947041138874381358421357979346969946153339116020262076240068191221471534081955949116115676675381366080183513_mpz,
 -2300828471235819271220934422541978404940109999698497642068730128666360043963010568814077445138732782427805621340645357813500213231196148130615096225696725791842936365616230928641024648098290563453649496099644586019949650212951041558134824016301275173590053563515688802908929395281427135073_mpz,
 561440712247866417744406902120332090740025688575199519682709158270803337556987276686843546845850914142739876059553885073128319324480205770266993969990747853011472024071908730312588874374334649839123742566049422393355371181270818521134498215678136728546827233443604791600104315387896321951_mpz,
 413175780728453742080320336514998921444789026335280313072022580708564247089292315973655024157531362525717648521493390028004999074857009112243638184944935532717890046232215471278627717950840216121149380830074971035780754514340260955003086404036859262420972716804062905902493459437266283991_mpz,
 -2474609529688690465514732007219741201395463565456024794253656163101984569274406526046991924742358477995893315627210691670822449334269155083937721333761262634020169720376402428077331763172405722483298018764462758173326336018026844774519646502261830772196060224159394444712840270871463674137_mpz,
 -2433477669395522132055377772548802090244386728427972004683972058495170043542515272920251424482680267257462631631575764855638606789376968470698159256186458658605509654212183545034807327003139443214013001610000641821120942141471621318569296715497267685664483086445141220393542402561528880097_mpz,
 581069413879207244221230326510103194537710302249502616783153066090163951483565580361266241370581057796663873389023303706983061648407675375326649623962473783340574695372835532476136454826665552399321524588531376853377400250351941856275469365387622140307699916064480493062528473617900359839_mpz,
 -1033763548798480172965832288843550123506820546016639827265970059191769353337828995531612457137884239471049983126457568162217813864208181399283199653317470529477784095801399492486063569254809215496358629176899457297556886090107799809723152947957809612905267577870668123509855684625693336041_mpz,
 -2421098967797028321768112258517187720505230679516910108762841063333532683496863375729129089522692220961412617787275851601353356037201158558826712458833346618159176623118988272755735742288728392651677051390290856602873715799851229635298977707337128774927856194959766555808195096695316294233_mpz,
 -967506597634264956815835637016003663159756381117828906830048816145434829488644278722728286345392618453500853787934129034729886963320154558714625529987935920319338116118766813999638142498606050554986842759283204720827000013194940564641472334211644921004832775558103051806295748290182688353_mpz,
 -2559894001466743909200859475168953112020919107621376758708817903123438992737393556830788228916103046560848242195020631782931452878751989073224156146065049520682868352161307689842714789937281575914922846061089921470893107215103559417847853046579952831960628068895554555373987529668866835809_mpz,
 593811727977158812855769693874109792293624381315972612011949668262198127485867180814543864969259928724996939155310416451455670260882487268113989946836755834557803589375925417776498435694090156208937958539586420246059681764772355208097652151464918897813866782460445209864549209923087477591_mpz,
 -2432282212440019011002781968446241756034841991011267416331654828324785947541551790902177097720934334971325671992057644890117276876752757807594225290379101037798166225320788055898111393495544560390737684945199195540958916627589627287368789336079662904735570426359414784803425809384904382617_mpz,
 -1115593037192523878779333332232541521053374048190918010133282581711304779479932204302557520800646196814608451166774724605749724114922328153868242796290433231286624083086420107399427300704531823070255213465220134363383089175239145656592618027976487589975750938273215188670554487166562882017_mpz,
 -2549916873467562620645799874572032656016611964169174832479563291585270342915725130179990079918143111790898557424256352345452126241884953049124013987636598771205546932390803669633464181414063782835320924693465738435877627809322862701166325870027714652540534058108638128383810898580647596641_mpz,
 414984516453432066318674350901254653101500155030793708865651642851572802594463266333656200407598975652513171469301617605924752791505392628084017379132923993723915692220839528973481523987742398644758394301020720844245101273232571952892331030375122273678964586008581206570766349665590429079_mpz,
 -911078970450696074178545554588130326014965248956291405482755017052557386427265433091369811732801838650605203178279300777962515076892398685864450976728511850647997486950652482697699980936853819566076706163151617769758417338153214897592617281817996138632748234856219995079548011581338770393_mpz,
 341771636698065394102016141703815013123509053903564794537812930206032813102455998011535615980436406627305429861520983468766236480315652482302316616470460833861215504976553072110378666073576355904616444094087785003959335133874017505656985661590557132383087467835869833355680009076221632927_mpz,
 398310665253036974298855761258810577160269781736967804825080084439171415367153705511566089913735505156603900319661033718989145354639613610268337985020332210281603848002217198925202706374221145371741460951361765603599141649959596113204404181471530140618882665931582944954131660478966389151_mpz,
 455677919532396127302799668384410761696249450314904727699282903152211998949937707704160440968493447223926857031856050203950519844288379871133912140588510941980419966694082650933088304730876889521270381192414189902694261081820690043575734277417669419767474964473581229941226469523014859991_mpz,
 582641602488761706450803767737622621162797565309268827161984078005129042202378474925642282774532717937921771943719369980783715867611929008380644188413143665682051846353295084288758347367550982338479711171136438163575748794530074965193019733102901662397239032001013799501438016457350335463_mpz,
 527978185530672926714128241063954550266645827303717194770276837088648739585755666673991927437042891709905466750592198225658794419710911802734783891037229190077581404790939676596329913647741541530900252127722768011131394590399561627267964484048676931557381775814093445734264252842827226143_mpz,
 -943422521645668881695232749260228978029118725267439320073933144873474967551653061181309658909654810959030525565549206800378338770436469944224116415532607484150884501112521129401276544018383399593956327718147690515561302903429995010446425576941329765246878458430737930413507553358218262881_mpz,
 400011592785711128761696077344034858863382915965703697938613738202560300343435648559707174359449758278348003174514891763474722515003246730512263161530532072891157798924142592409842837282177519050210763417281775390075843159668200806951200685107460464536262815536653945747453468091352105239_mpz,
 632823521488228966709624519548190927995674887539468147549549546590261115863692471603521715500787545509876455092051295503432322732530613299782603973677371377371213232104278197889692194092078995513470083908433083201799593597373886778616626755095899477978919177629915280856544485125109184167_mpz,
 -2451550417859630328764809314506125126824830503200083518063253472392778931043034578681521644234333489998568082264695184136480211238322665033007851885705276742728911821785778343619790174203688624524960553398373072429209474020879195800703519872035952398694844841547790881643824677312259304033_mpz,
 574301137008008033933371945865828977948512219734989946444835571778444214687085484441827222711850391357375114358406201565113014036160133726144814811589151766718146745133084332176311475292198424384037384899205944355636411812538547267960067435169246336624571549315325781800976813350432586911_mpz,
 554686746179761921738456306250955533211732107498504049656565360319995584423600368411792928855021302596183901867376289952158355039792776267220875304983625019344463211666892789180106617962384397950288798111950625477762071138714212334313085300296081947016434119211726629062545833661059019351_mpz,
 -2525998149422879759536141541250329003243197795890839849215291504591756279472065361238640300170415366237562305868669316689536439441059790377537392302781850762636225781545038735879620867852184827377487847685482094364416691948213662678549651249068913381803425310638567040310369424918902195097_mpz,
 -2377753796930789240876572145119859897201944318722163446030577714598089861754702345951550467047964205754756970282671813009686614851566738675932126455562541649448994279347629791135683328965566467666139875997810527499446300468556592707863825894365365154268611251076761463720500189206994149857_mpz,
 -1024571376888577586975123514454607062610555326469059450208082053820411977280256525495467923450076448687220877794505836726041775090993886024360268422480539172447599597676493228276850695046540215233645657353313810196317513248877354118239167378297407111108777444022628406638929050093578282081_mpz,
 -895869796260264959163142889908962010891918513679765065769392653593410572583751879781553318299563937600371771354782436911014136514176266348770064058922641455497963543963940685430501070637565195111272497068647147631813114929795339822963414705506747313547495986906650682603438884948039145321_mpz,
 541290273139800258744369765164623013489403147641451651656912484397313758813879307703479879737112986826658970166428818526347998624117353842005713121495306759803234978544352988184546696295546140207145532620057855019865097074255796492336689658159627279731423158661784418351901630352709195047_mpz,
 -2487486284370392429040599009706426033085565049007596086253969402963982593212578506996627058921152603104207123088630015429524430856674667963411695007375307991228283541158727203789470049395398034638763111584835793580378880965944006694308693218006639943546784015185014878937009566109956543073_mpz,
 -2466919294806344504191463291877617629209625372186572202636407278290117289025175932898432304729533672938712087517841967281979305469927701326730899935007480778937007262614888240344880729412432183920656193712324431944878472500176016782337949227168168410820837759970299154415275143208878963809_mpz,
 -2510939496085899248586437008764420816908071829194488598280346761427501999732597740294974376691876416818009205045499326424909635154225710053911260315405052439002947811151996197952040872453031155885824152017217344133857541400250184890707349348228107523912862589066683376468377994245206289449_mpz,
 544845350959738665976979715416127016828499516257589607296850118650319080826602152723395169950590301140765538801828460770666742349863063607190213182972347790984510830445644022951972169353847180224068288499648072343931192538996813675086420896636803597448846711003561958805838213838025951463_mpz,
 -2527527571505594550378855244817646680830685919186402237974213215574033307898811328649180959715778602068006505788594597680169525215790563595208554907913208666495797285508773112940356074817714318191665611934827025935979296048029320281190867332376108077683060240938198159481646716783000736737_mpz,
 -2546213188234695599446455431922356318493000167210340217659421617558088226181776709798851980757067282047927368684208505882583338524847398459738545708911841610729173022623946818614176526559264223048578343791471571072092931504708148045343520868143981636215648568994355373557872166704275358561_mpz,
 332350908204622365129654815372738492537471950072195223298484492021300377111721932743382235099065878106539133885486813157042966790632249287188936554588213450299602779699009425623143542515800364286593650400012213062791560022905926917823171695167971172541500471594153897635505896673740379159_mpz,
 -1129581105907289352451082123732590105411247511424647147159410524113643019485977878773753721267191201868532490062833331598392841120943839209268328998170699190050147839283899902040100877103390718990695876076820109442758320499918974285038754080724199634649818159448376302999892330848978438233_mpz,
 505206283129065060765419948308155296870848121913455064403953218529373634288234492581411172108107049963910213484824935212736073992984999089706157167989530026171678190949330051512975027262517376969954466739919748869537196790036545820957602217763270673523043736085518196315698294111521247647_mpz,
 631933644447139416635052244549636598146207061802782884626111741187726402063123923140838126140862862558590720750134974778490793691988207481349380339082673208390239402828138637229513095137155592615571743613466122793604282657100951354683853513735496068905109229243361084641797954290943585951_mpz,
 335516946405923945057860335644626911513881309145988529799027912627231224071646911649058363705632542897297101631197850034811638180593612340051981027681182601064726806600626379942191267111788529861966654281306007436025074494819977231285131190471947047638209945965744059098506231496399731031_mpz,
 -1142367706823078543956901839249456796992268753571215876994184446088197301163945530756388819586357240199343402787424025269135330202236417266453677061242630820213294846588153348005057218299130267351453671616914667685933291724596824910120062217685743793784062697601045922359673764958903217817_mpz,
 -909648228143932333217357035457133354091004102193196756317557159074501438072820665893493841653473396940770686815438830390188716794467891270019795618081335817076149168497240681412761728083312261270800573279730868804895403781386181620208607496281709040721505194700357964259230780960162073057_mpz,
 517567938366922256628004958134411546531911472365187378938479371381774432732999929605539781509032962608577237778702701627221497190033351540517316063210074999350857932409524546327724119834626036519504191386476629526984670851554588215583536892556253448191517458173299455147881025341993232799_mpz,
 -1100631952773577236506621559276939633995344430290660076383254883754912953271565249734739483047363316777590088561870846627509835423509022532220967193240714150754892392184611201751560138884640160385434491946474514554692114310251655218540969832361620892580023145176166857366414798564394822761_mpz,
 -1075156544067957774833759319352336116717164190751565930863134541489467186551320868012506891657778603462377806613190508282979364210956971262953501683230841451732768240776949995395820131109345917066699076913164006852625072784833874371080590435912101079101981577618932434050330014238128640473_mpz,
 -944666550040631043046595954071700988804521085583822321299096680675033910359849786850528599237559425842760533833946404462392858312513515206519701980921917150075905568351476051892814575824461773337234984098693892952738558379095940314631022576081459207723832705936897684946005788367711039073_mpz,
 474348162508623885551407455284759770228595750341151705991944870802148524086497309151985512902464204545317451105095022365787434651528134829897869846901091989266256423427876411685297256394586691334843069235957779411355964483450023027751832992467626675672636895685267400103686123483653334431_mpz,
 -976986372560247571053934359603279056074817276287836915047072858888072306409368084935163695287988911425854062429478333494606916248935943220750977616298670722068751383931344106639339474787741536035716509336380152300613633791638912480042585685998059620981529455844844795659142175785946883369_mpz,
 620014382394732566087493365346116404928513223258097812825766607630529047473233801493100691104841046052339069883745107145024196562652015014166182307258981595403048069707874945999570389432159495811034806813705645516866470253786975949586168850214959823289075803880699263085157884289809898983_mpz,
 401236364816326971339964444922485710693647684567217399774786183367161890713619345709112867387473777091484504630244788649184714551929127617747269552233511750284827338594514674441395486324118722503337011713578690435049930865890279137210219479784627648423030954281428838895088424670021921823_mpz,
 -967020301908746285198053104171073716542937990784768787438407084909744886795678824944874973040758269846216756323672731512025891005597696381296962856880836189248785993783423814410452623661810606089932028532186828109290792590620012333634189876884777644983072843153830828877348941287725606241_mpz,
 -1005964133554064333531342573447197895952731253831957050020419441938365617515482235540173372276251640012362477820413166832210080405704529141144064840865687673103782764012927277809016165529534178332740643519225601701516814392091782009215713330936321007788299810111895978101458197491436351721_mpz,
 -952938045282296841957733295280468037929607224209307265836422901425658812147756823636708412332041168314501186219938418372210117355649520064539554519395843188345532852386098091009786549233675301418839926302997874809284573632606443169329819461559690393621918477047550457726906081413015818073_mpz,
 497192805077466360966991657726797925117022050165081350822886922277263080870832796352298636834776468716671316449413772840222513857349473356281833527088466563373069408077478052963208498600414836621590028876461546901139505933261267951094083762742732807570686401402193052499538742556776338847_mpz,
 -2515320054208066762563176679113600317858327277708038476781458604775020622668555830071929324105560188479250154505833991547170382926676037919232860941442234090313127843775104247354022964705181670788122350473560646551809283633526812952829368661754710003586846724792166057556496311284498843489_mpz,
 -905963769823945241617759236062018294224670933048912548904880726410036123069848317418110859363774477128010497794346676331644621718523427564848126392856368893592017547025427448165211453701524240489650869657249967902344377566781117215620651748274252069856830028870685128382445283931203864489_mpz,
 -2549896637524903207413769606245328969354053645020810278474872849920968732339787056087480312707326881612421876477813673312361752929468607327988591551607580137812321248835840170145441367757778169066463588214096524822587904855730881399841415277238051601728023134223463803462389279191875412377_mpz,
 -2514870743874348523671510573665253748626713787446082418127298539676082561328094850665801226702514161197335516220166950049287550200511685526702185631014020472774897554591936679722267257013078217394989769929279892568120630861208798520888778737840237003778789301369429667688372253933805285857_mpz,
 -2600533880319580977516419902123390569100234867378559249834694159532922386376257190915139288742420772509931667060265426145202281145942098499919446177064612834230860086391073016969864812750160873233615585035806995930737930014611857798205196367096806475958360566020897281825870897306186850401_mpz,
 -2506426454645298273668407828825972844517958251780157964894361796122156506283645823460506786454215222534094815111326028990657272523472211438239872130788678748097373689464236179711476653095239087983830197914192992112771726991688167989235897407706804146800052339040938304947361115799286907241_mpz,
 430502462276527609878030412019036120391999383152550280259561830077097985046656221928390404372858413048810185289199783044321191920023538726059169371007107170735040646705676222620435827672095027349346256545558344553027662450256822988651397548052811159088243961135288616486529732038547308327_mpz,
 -2563714653268941448617114775958425478701501099803605361484574058575159061156575514743591460681729379552496443240351153722905846572292668093671767008678212956148485661612242539855956816544902313891909769405522728438170131409209611679151759874856870801054494861030392328279052660755715027553_mpz,
 -1021232264073712749226093759425199214903246008228644710653252579336739400461561318371402544039767038585093223376963738776350959210356038910883088046437810645947666813819275393348094149479516281159713840578121182250833832957963078895753518715383712192845565567829662491984938120165549985889_mpz,
 401631044924006242295937053540552239848058313341049148655307826484332254511035562505270177926159731109666759771742636401297785854105403961834879084152815650091395809360321366463378531834626358950438511382017710963923380681625077949402497478466531546686220651784298910467718428990121155031_mpz,
 -1165472211914261533718621521136144516631669332188313185518423875025642292678481502917173230761609218835749404040360524076971506931401590399250195280800029524300071544882177390653957864841676988886569204896847553152277459890243969433526377853421092077131154931646873803461705424842467429657_mpz,
 -1110227396865875475374895489316943726099780180021182147292785919156903677833167109189610754529921929268114928701540345882388899014068591621941368411699520287967153121038049256895277912069778383969711447341118726311194577149465236531751817494348549419495140007128797363957667720595331632097_mpz,
 -2426753030908297859667534515876018413859701384943958095814702184924303170726872174519160044224642874964668683596775244717806062864119799233589905485882861199356194468030297462482437374230640517362337450493887512018363253555239794710993120318705054368951463248747797723631213656012983080801_mpz,
 379329158453018435387304151195958490582378012393890838915529312555437913582605806849513845084853545446314828417577852403284253523929525019205941951650866958164060701260637525815082475151869965241828857208917829036990703228740353702034162488160438468866218551106122879734319913614279338519_mpz,
 -964941945570280577911802183919928655909377368214885803808190105796257841950980182712705697000849032096487017004871522781004866741642196796238295082074519989168871304406220563245491246943322723369895062557273499290163691293339986424395752647421285281178949089275173055295231050095465455193_mpz,
 -1078442817695915154559643618599209644742755701897850515591708703150189737378460072807584630641814623974841345692642968285345376106435374283027319310064587621355443353955713635828196519888946781007794212772650058037551990764982401104965904574767713251368230173023314900854853865537960910433_mpz,
 -922838988779340003768177342633575423489891509137285444490050245782650555233144325189278715702294784554415893245018940244087402078043098774363576059705775589560590910390285892327217910883378944964210506249032238024419234631678734605340999158863979945143006977076758175706932070374692167009_mpz,
 -883289939451421944421673206968259269255450466977407516772600527277425421385995634578981604091377633700455180359561038092726777395902874218214905862938353653109857255602814398759694492308427997757427646706524759459980184581524164182098720064600890074716946337499964072470997063809537546409_mpz,
 -2459811658951248399997443710620222687061171318251139667085696717198341164662161819516920920868124277437115980032243622946916588549968694729998004193946010159517129845048495045335305850963954708635660738506212391807759263634444192727862708392480210479705966859177708401452432498756344863897_mpz,
 555952148235204153003865997270911364341977022900059435032823452816205683278923293769608044756463320232165565591764390229372986635336111400766038772647193492843085680055952467866127899080684247428394810706654255068963603409999635965175443652305859960362818131845142241064899578688249493023_mpz,
 -2426915075473889307105997597024207186570798197452605503938353195886525996010782699699995453578022874328367758898826087045995622933955210388627199513767031604071649823854983830686853462594736379847712488977558988622774012646294385753616821787938380936050603024574363265534907842554925044321_mpz,
 -2419255629155406845924400331185339790959161872419657847302518057385819450118193215814127588473188705144492953713601820802932329359896336761217290867700524636411097530652186065306318896982315813990498035752568860257161617788330940588084501138755913833574732691794114199956794871632067073641_mpz,
 -2483104732299295195813053808298701345051948851916723677720730966760872246253717299877385189565005109887304797733760844564722276260719231988312322788514846281546738131059613286646171436292214027406149162862897060496515924769600532611772971871829324036477242172513642845810103033310130675673_mpz,
 492794560310228614830397001794418908168221992575766000278699297099768332572313196043809327910079620082439398007472585931327192343412519281693005459537162164757810311253353462171010985383798989369495572727691650551603212884080489656845507126190436551780206085422717917170620541430750472607_mpz,
 689234009704880653746212001418370194441426624414016159001999871064451373508742444285435968423964852989879790985565231003843497949822973217044801310467698238730677175900174180239986084048201849722440469275574680715131239602138759236976588561050052963507207307037746583018245651815692497311_mpz,
 -2485578960153625237378437690445193780602443996769510576641208350330506652523399444157839530513931177473079177584126623257919343915758048629244713049805606348691178179220784934945347172116057588399644984642033164601529811761879612329147336472161354828798709974332931666856209763972315746089_mpz,
 -2441990017652021588199276758278362814534776805587386783997466605234719559071823383819492665183386046059892869103864451205663610055959741852417418760524584952195481800587682271113536401830095085518891791897470709961704913886989279567540224253042144307941528874409552504718315945709921185817_mpz,
 -2481155398248486160027119864788409522054945026557493133812051069298977480564876568696687412480809064031546341718956304917484368972104854303908231840948230675205180867195565282235181185060048496507432784582712113727448604407237569846842075495897609916152044387378852583164140538517597580257_mpz,
 -834652398985048864915486593802353312887578279445639303689182165537500279409339786837804790233907953320941628272333329289980284885377895392502880583500143854514787554318921399947579514818152861518618803839296020929429532341445623228960824243987254878229921606814990642400091356429187545441_mpz,
 468010171327436298771675502809919424955935299778772242516491958159474127653804118986005596542487493735797372206282545815626678048887419151401955023553952289089158482065553654267168895964546843488981910716425335266624064465370099613319710341498584182212076601545712815357087582035605273879_mpz,
 -2462871921427281910416932953229972201541007977912165470766248082198298344971107372819230491930054484442329123843891072115299793767031623249132262406613350315596605071794636292115495567315026266898764475203277814684050676156336947016383763639799818199308416785604730997554572387563693544793_mpz,
 509846713423125743202179989312464958489709192782855499054996552214987499756020981898258126782855204836284068572752639790923523613217247156355363597931882311722994267562060541219620178281077715146819799251263936438947916719914697777453045229578798858403556254081937641828425285764848940447_mpz,
 594087733639754785319130049176586117566337337802129302230709666860342455720296514971164496310719608502156506733171739993094431750171376063790031901828057125229702464235640030125946377449544108591707650507291354840391558059758889387045776435699866634131847274011872251749098580167059049631_mpz,
 462984842958888205693352522202759903829579897195129440092834370335815065529575857456801615262094861765488237791662953606007650464166726288709803746086576893622642093477312890832864613298402787802445974723815931365439661561448648098618125414361646701307152935988219864791756292284587042391_mpz,
 -975964713045227378348514046686905168936703510025009966899911053957320154962937318659744467023181690621238775764131286127825526939031588121629568189722701596358868913281788348456084389208913983544183984842747573278890205507823248431122143396544120208121478132392662284766998730566427002777_mpz,
 495821887670857795918992179728789887747688035768576336384478226774585323204780361740162164588536852904612754307100540693539856672417181000500752526235757244532498850427391961839796307458861292271912659155956238325711507521108128729788938487468544977997270585295187720495538916686578120223_mpz,
 449322690387164621641519944655683969063506345247928689165569345556444001100368862497027931736409407219617650716059028203188121756309580462337809712776341768815778107648042154555264062637206550184626991974617303083755662972602868430002346416371624202365679915441895606801649318672926718879_mpz,
 502792656256801048620158122246794733461831479593653623286797646892767131895342716441371044090607144309984991022336071793572729688308033704586617363736167742202854163589810770263345782995000508997617837722554223288721449134389187238456925632765370059534403375755351558534093619722647323799_mpz,
 514359564079545359895178369552393293280769905637171224196877202895466925424069952302891589491559664068453062280712977243952712404247218908404192700273822911717900534596962877601808584558303720778768943959093858957797973847827486425826133385438965574344781907288274490218261757389204662567_mpz,
 348065891551303776248825065716195557461041395720111709445758164375534566021175547222036959471745971479428116116690051333512222225812929641704083655517864694275108041196853552205995149836633615770756395396152055171958813044420160024982381193032658133123188762288289637743398442651925200287_mpz,
 -2619613314848022008206503067728943473049588602571542644387171493146049469402741203404983862690172664241885295420073077887974828119961202881615592989926380578659583799859781149509253207560664014470430822939426051433024117169699052178251920178263939878494394704394473091863927080400771064929_mpz,
 -2515265964210974601195882022250709394728720501835787820984407547207055746179586330749717317232735713447043949839367899714338779626270559288920379065531699049918164732650396228617665517643650961587357805562871124836619809552082922377920831618399992967629933798863368968471664956443006711849_mpz,
 658027651646882279446164582479055106083115943446626709530824377387330157511846555598106193530157254818881211676985380823704449091972247624644874881138594024535650403565240332559240994191935766849685917805444001980725458719942636119908102138993694894041822782638474802521160111862520057063_mpz,
 427946639077747218862504650570864083203498140526454212922367537191533994500836745981519046873621117262262555406983032761945066173524622416142170597262263169329982406232023361014545938756932007472872447325160376990746622648496035648414408042326807213662693912769914048041296932554336586783_mpz,
 433733635529462175473228356975336942454200330967083879627669723557830929865197516522578077111676135754444056581772261267855347867984359375111407809525410363605085591107957582128880156436511176641743194690518252299851293596441627694488446420880783527435973992809228940457880769267814200479_mpz,
 -2592075659292736396400244703034509717821643713180367875485287425386562816346868402682919720510334250878580834805103566160730446751582700563929753944141691066792187568289710686998342886686687261353685944270232585186229813566246390808008969486787258376291797230999798984787986691668868071401_mpz,
 535212050145181706306585970312274157928015120808696837880375983519241813854857165449665790685800854884937020869137179840047760020822412728759190613360539572549533994578537326753995930527351073590145544823382671389818515747985574666605033643869347639394913384151809481664451120234951904167_mpz,
 508793865599241843619290767891137696266244350320519187749888846564455816600413532399707181856999964281841410134137200835227294635029112522261848906431502352800558391596669256496107541856332332519659605434625026532807571217156184774281373358093441601137994817486517668303129530045117387167_mpz,
 -2473600759787939224394698165322021741123365006851241563546606393546964249945411141305854976816411290954984523848350087486669677436420077628888386066509056925195964853829580302937899309257666229850414590674595660497686279009993918781661979239575709356069510830040974660121717655240719282529_mpz,
 471886350887667968297009646094353739999632810756543014546260499365444859794486569804326888853019751585703355342460701357376157780149675320503577642806225088621768816418069496441313657669133157679659564261085783868864373435531093467875206580607158216133454392929249279676854076960483581271_mpz,
 -2492797044914106622578306327646815110666888901378928774437190507664949766111684433035838424107009741549627250331238413275997970987024389976597258950618210789731798534495610042059325139469726440185001553416882201110520031628159366364611954134652688329874719968992394275534963918439420875417_mpz,
 -2551975926193860007727615062179413374061743407801870282600836993386902510431736393802341277636036513792485747781317461771351173888946325649413144310027105306524146828581854941410441075479296039161348588143688857099853343870599287354129970359513755262311628817111460065761246693071592135137_mpz,
 -2503233238377420501879074356359788201631558927282071452395204421133199728164250684218641295206869272405257891841330443647195689413331613417784361440907559995117532355844251852144424702694529059678566925993592823609362205522538988054114263441206097863483228711783348043529852221524805901921_mpz,
 494998154680813906536197718858784945779374488098585863429334924612150492252308410686002470883677108543241932181663051245592515905989378086942647354464904805555204549366376578878529702508980944682074559470607732294217542299943989348955447680534697371445662568892776354422318805069956214679_mpz
    };

mpz_class DET = 70379674497864884941644999435526227227896566933754691801972856973901320806610419340463486702417509738352173293325620252611063358153913357449987495775293419047555682030170330870008808783209068554802336724884331497574293217303853638439716855617747775188674217628708842326066013946551899265095680_mpz;


int secret_norm = norm(secret_vector);
int diameter; // = (sum_i secret[i])^2 * N
int ** V; 
mpz_class ** Binv = rotation_matrix(secret_vector_inv); 

int * dir = new int[N];

int * vertex = new int[N];

vector<int *> ALREADY_VISITED;

int calls = 0;

int main(int argc, char** argv){

    

    cout << "*****************\n";
    cout << "Max value: " << numeric_limits<long long>::max() << endl;
    cout << "*****************\n\n";



    diameter = 0;
    for(int i = 0; i < N; i++){
        diameter += secret_vector[i];
    }

    cout << "Secret vector, inverse, and determinant" << endl;
    print_point(secret_vector);
    print_point(secret_vector_inv);
    cout << "Determinant = ||sv|| = " << DET << endl << endl << "Secret matrix:\n\n";
    cout << "Trace: " << diameter << endl;

    char a;
    cin >> a;

    //print_matrix(Binv);  

    for(int i = 0; i < N; i++){
        vertex[i] = secret_vector[i]-diameter/2;
    }
    
    dir[0] = 1;
    
    for(int i = 1; i < N; i++){
        dir[i] = -1;
    }
    
    cout << "\n Target vertices: Rows of the following matrix \n";
    V = vertex_matrix(vertex);
    print_matrix(V);

    for(int i = 0; i < N; i++)
    {
        if(!is_in(V[i])) {
            cout << "not in!" << endl;
            char c;
            cin >> c;
        } 
    }
    
    int * point = new int[N];
    for(int i = 0; i < N; i++){
        point[i] = 0;
    }
    print_point(point);
    //fall(point);
    return 0;
}


bool victory(int * p){
    for (int i = 0; i < N; i++){
        if(equals(p, V[i])) return true;
    }
    return false;
}

int * fall_orth(int * point){

    cout << "Falling:" << endl;
    print_point(point);

    int * first_bounce = push(point, dir, false);

    int * bounce = new int[N];

    for(int i = 0; i < N; i++){
        bounce[i] = first_bounce[i];
    }    
    int * orth_dir = new int[N];
    orth_dir[0] = 1;

    int bounces = 0;
    for(int i = 1; i < N; i++){
        orth_dir[i] = 1;
        bounce = push(bounce, orth_dir, true);
        orth_dir[i] = 0;
        bounces ++ ;
    }
    cout << "Bounces: " << bounces << endl;

    // Reuse first_bounce to compute medium point

    for(int i = 0; i < N; i++){
        first_bounce[i] =  (first_bounce[i] + bounce[i])/2;
    }

    print_point(bounce);
    //print_point(first_bounce);
    print_point(V[0]);
    if(is_in(first_bounce)) return first_bounce;

    cout << "giving last bounce" << endl;

    return bounce;


}

void fall(int * point){


    if(is_already_visited(point)) return;
    ALREADY_VISITED.push_back(point);
    if(is_far(point)) return;
    
    
    
    
    if(victory(point)){
        cout << "VICTORY AFTER " << calls << " CALLS" << endl; 
        print_point(point);
        char c;
        cin >> c;
        return;
    }

    // First push in the direction dir
    int * new_point = new int[N];
    
    for(int i = 0; i < N; i++){
        new_point[i] = point[i] + dir[i];
    }

    if(is_in(new_point)){
        fall(new_point);     
    } 
    
    int * neg_new_point = new int[N];
    int * can_dir = new int[N];

    // Canonic norm-growing directions 
    for(int j = 0; j < N; j++){
        
        can_dir[j] = 1;
    
        new_point = add(point, can_dir);
        neg_new_point = add(point, neg(can_dir));
        if(is_in(new_point) && norm(new_point) > norm(point)){
            fall(new_point);
        } 
        else if(is_in(neg_new_point) && norm(neg_new_point) > norm(point))
        {
            fall(neg_new_point);
        }
        can_dir[j] = 0;
    }    

    // Orthogonal directions (they are of the form e_0+e_j)
    int * orth_dir = new int[N];
    orth_dir[0] = 1;
    for(int j = 1; j < N; j++){
        
        orth_dir[j] = 1;
    
        new_point = add(point, orth_dir);
        neg_new_point = add(point, neg(orth_dir));
        if(is_in(new_point)){
            fall(new_point);
        } 
        else if(is_in(neg_new_point))
        {
            fall(neg_new_point);
        }
        orth_dir[j] = 0;
    }

    //cout << "change" << endl;
}

int norm(int * p){
    int res = 0;
    for(int i = 0; i < N; i++){
        res += (p[i])*(p[i]);
    }
    return res;
}


bool is_far(int * p){
    
    int * a = new int[N];
    a[0] = p[0] - diameter/2;
    for(int i = 1; i < N; i++){
        a[i] = p[i] + diameter/2;
    }

    //if(norm(a) > N*diameter*diameter/4){return true;}
    return false;
}


int * push (int * point, int * dir, bool bidirectional){
    int * res = new int[N];
    for(int i = 0; i < N; i++){
        res[i] = point[i];
    }

    while(is_in(res)){
        res = add(res, dir);
    }
    res = add(res, neg(dir));
    
    
    if(!equals(res, point) || !bidirectional) return res;
    
    // Now proceed in the other direction
    while(is_in(res)){
        res = add(res, neg(dir));
    }
    res = add(res, dir);
    return res;
}

bool is_in(int * p){
    
    calls ++;
    cout << calls << endl;
    
    mpz_class * res = poly_mult(secret_vector_inv, p);
    
    // if res/DET < -1/2 or > 1/2

    for(int i = 0; i < N; i++){
        if(cmp( 2 * res[i], - DET) < 0 || cmp( 2 * res[i], DET) > 0)
            return false;
    }
    return true;
}


bool equals(int * a, int * b){

    for(int i = 0; i < N; i++){
        if(a[i]!=b[i]) return false;
    }
    return true;
}


mpz_class ** rotation_matrix(mpz_class * v){

    mpz_class ** res = new mpz_class *[N];

    for(int i = 0; i < N; i++){
        res[i] = new mpz_class[N];
    }

    for(int i = 0; i < N; i++){
        for(int j = 0; j < N; j++){
            if(i >= j){
                res[i][j] = v[i - j];
            }
            else{
                res[i][j] = v[i - j + N];
            }
        }
    }
    return res;
}


// ATTENTION, this is different (ij -> ji), do NOT use for algebra
int ** vertex_matrix(int * v){

    int ** res = new int *[N];

    for(int i = 0; i < N; i++){
        res[i] = new int [N];
    }

    for(int i = 0; i < N; i++){
        for(int j = 0; j < N; j++){
            if(i >= j){
                res[j][i] = v[i - j];
            }
            else{
                res[j][i] = v[i - j + N];
            }
        }
    }
    return res;
}

// Unefficient
mpz_class * matrix_vector(mpz_class ** A, int* v){

    mpz_class * res = new mpz_class [N];

    for(int i = 0; i < N; i++){
        res[i] = 0;
        for(int j = 0; j < N; j++){
            res[i] += A[i][j] * v[j];
        }
    }
    return res;    
}


mpz_class * poly_mult(mpz_class * x, int* y){

    mpz_class * res = new mpz_class [N];

    for(int i = 0; i < N; i++){
        res[i] = 0;
    }


    for(int i = 0; i < N; i++){
        for(int j = 0; j < N; j++){
            res[(i + j) % N] += x[i] * y[j];
        }
    }
    return res;    
}



void print_point(int* p){

    cout << norm(p) << " | ";
    cout << "(";
    for(int i = 0; i < N-1; i++){

        cout << setw(4);
        cout <<  p[i] << ",";
    }    
    cout << setw(4);
    cout <<  p[N-1] << ")";
    cout << endl;
}


void print_point(mpz_class * p){
    cout << "(";
    for(int i = 0; i < N-1; i++){

        cout << setw(LENGTH);
        cout <<  p[i] << ",";
    }    
    cout << setw(LENGTH);
    cout <<  p[N-1] << ")";
    cout << endl;
}



void print_matrix(int** p){
    
    cout << "**** BEGIN MATRIX ****" << endl;
    int length = 4;
    for(int k = 0; k < N; k++)
    {
        for(int i = 0; i < N-1; i++){
            cout << setw(length);
            cout << p[k][i] << ",";
        }  
        cout << setw(length);
        cout << p[k][N-1] << endl;
    }
    cout << "****  END MATRIX  ****" << endl;

}


void print_matrix(mpz_class ** p){

    cout << "**** BEGIN MATRIX ****" << endl;
    for(int k = 0; k < N; k++)
    {
        for(int i = 0; i < N-1; i++){
            cout << setw(LENGTH);
            cout << p[k][i] << ",";
        }  
        cout << setw(LENGTH);
        cout << p[k][N-1] << endl;
    }
    cout << "****  END MATRIX  ****" << endl;

}


int * add(int * a, int * b){
    
    int * res = new int[N];

    for(int i = 0; i < N; i++){
        res[i] = a[i] + b[i];
    }
    return res;
}

int * neg(int * a){

    int * res = new int[N];

    for(int i = 0; i < N; i++){
        res[i] = -a[i];
    }
    return res;
}

void print_visited(){
    
    cout << "/// ALREADY_VISITED" << endl;
    for (unsigned i=0; i<ALREADY_VISITED.size(); i++)
    print_point(ALREADY_VISITED.at(i));
    cout << "/// END ALREADY_VISITED" << endl;
}

bool is_already_visited(int * p){
    
    
    for (unsigned i=0; i<ALREADY_VISITED.size(); i++)
        if(equals(ALREADY_VISITED.at(i), p)) return true;
    return false;
    
}